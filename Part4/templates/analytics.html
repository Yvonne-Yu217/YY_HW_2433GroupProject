{% extends "base.html" %}

{% block content %}
  <h1>Annual Pricing Analytics and Model Retraining Output</h1>

  {% if error_message %}
    <div class="error">{{ error_message }}</div>
  {% endif %}

  <form method="post">
    <label>State
      <select name="state">
        {% for s in states %}
          <option value="{{ s }}" {% if s==selected_state %}selected{% endif %}>{{ s }}</option>
        {% endfor %}
      </select>
    </label>

    <label>Year
      <select name="year">
        {% for y in years %}
          <option value="{{ y }}" {% if y==selected_year %}selected{% endif %}>{{ y }}</option>
        {% endfor %}
      </select>
    </label>

    <button class="btn" type="submit">Get Predicted Base Rate</button>
  </form>

  {% if predicted_base_rate is not none %}
    <h2>Prediction Data</h2>
    <div class="result">
      <p><strong>State:</strong> {{ selected_state }}</p>
      <p><strong>Year:</strong> {{ selected_year }}</p>
      {% if prediction_data %}
        <p><strong>Predicted Premium:</strong> ${{ prediction_data.predicted or 'N/A' }}</p>
        {% if prediction_data.actual %}
          <p><strong>Actual Premium:</strong> ${{ prediction_data.actual }}</p>
        {% else %}
          <p><strong>Actual Premium:</strong> N/A</p>
        {% endif %}
      {% else %}
        <p><strong>Predicted Base Rate:</strong> ${{ predicted_base_rate }}</p>
      {% endif %}
    </div>
  {% endif %}

{% endblock %}
